<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>{{ site.page_title }}</title>
  <link rel="icon" type="image/svg+xml" href="{{ url_for('static', filename='favicon.svg') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
  <script>
    (function () {
      var saved = localStorage.getItem("theme");
      if (saved === "dark" || saved === "light") {
        document.documentElement.setAttribute("data-theme", saved);
      }
    })();
  </script>
</head>
<body>
  <div class="bg-orb orb-a"></div>
  <div class="bg-orb orb-b"></div>
  <button id="theme-toggle" class="theme-toggle" type="button" aria-label="Toggle dark mode">{{ site.theme.dark_label }}</button>

  <main class="wrap">
    <nav class="quick-nav card" aria-label="Section navigation">
      {% for link in site.quick_nav %}
      <a href="{{ link.href }}">{{ link.label }}</a>
      {% endfor %}
    </nav>

    <header class="hero card">
      <div class="hero-grid">
        <div>
          <p class="eyebrow">{{ site.hero.eyebrow }}</p>
          <p class="nameplate">{{ site.hero.nameplate }}</p>
          <h1>{{ site.hero.intro }} <span id="role-article">an</span> <span id="role-text" class="role-text">{{ site.hero.roles[0] }}</span><span class="cursor" aria-hidden="true"></span></h1>
          <p class="subtitle">{{ site.hero.subtitle }}</p>
          <div class="hero-actions">
            {% for action in site.hero.actions %}
            <a class="btn{% if action.ghost %} btn-ghost{% endif %}" href="{{ action.href }}"{% if action.external %} target="_blank" rel="noreferrer"{% endif %}>{{ action.label }}</a>
            {% endfor %}
          </div>
          <p class="meta top-gap">{{ site.hero.location }}</p>
          <div class="quick-stats">
            {% for stat in site.hero.stats %}
            <span class="pill">{{ stat }}</span>
            {% endfor %}
          </div>
          <div class="wins">
            {% for win in site.hero.wins %}
            <div class="win"><strong>{{ win.value }}</strong><span>{{ win.label }}</span></div>
            {% endfor %}
          </div>
        </div>
        <figure class="profile-shell">
          <img class="profile-photo" src="{{ url_for('static', filename='profile.jpg') }}" alt="Louie Hegeler-Meile profile photo">
        </figure>
      </div>
    </header>

    <section class="grid">
      <article class="card" id="about">
        <h2>{{ site.about.title }}</h2>
        {% for paragraph in site.about.paragraphs %}
        <div class="item">
          <p>{{ paragraph }}</p>
        </div>
        {% endfor %}
      </article>

      <article class="card" id="experience">
        <h2>{{ site.experience.title }}</h2>
        {% for item in site.experience["items"] %}
        <div class="item timeline-item">
          <div class="exp-row">
            {% if item.logo.type == "image" %}
            <img class="exp-logo" src="{{ url_for('static', filename=item.logo.src) }}" alt="{{ item.logo.alt }}">
            {% else %}
            <span class="exp-logo exp-logo-badge" aria-hidden="true">{{ item.logo.text }}</span>
            {% endif %}
            <h3>{{ item.title }}</h3>
          </div>
          <p class="meta">{{ item.meta }}</p>
          <p>{{ item.description }}</p>
        </div>
        {% endfor %}
      </article>

      <article class="card" id="skills">
        <h2>{{ site.skills.title }}</h2>
        <ul class="tags">
          {% for skill in site.skills["items"] %}
          <li>{{ skill }}</li>
          {% endfor %}
        </ul>
        <h2 class="top-gap">{{ site.skills.education_title }}</h2>
        {% for school in site.skills.education %}
        <div class="item">
          <h3>{{ school.school }}</h3>
          {% if school.meta %}
          <p class="meta">{{ school.meta }}</p>
          {% endif %}
          {% if school.description %}
          <p>{{ school.description }}</p>
          {% endif %}
        </div>
        {% endfor %}
      </article>

      <article class="card span-2">
        <h2>{{ site.snapshot.title }}</h2>
        <div class="projects">
          {% for item in site.snapshot["items"] %}
          <div class="project">
            <h3>{{ item.title }}</h3>
            <p>{{ item.description }}</p>
          </div>
          {% endfor %}
        </div>
      </article>

      <article class="card span-2 cta" id="contact">
        <h2>{{ site.contact.title }}</h2>
        <p>{{ site.contact.description }}</p>
        <div class="hero-actions">
          {% for action in site.contact.actions %}
          <a class="btn{% if action.ghost %} btn-ghost{% endif %}" href="{{ action.href }}"{% if action.external %} target="_blank" rel="noreferrer"{% endif %}>{{ action.label }}</a>
          {% endfor %}
        </div>
      </article>
    </section>
  </main>
  <script>
    (function () {
      var root = document.documentElement;
      var btn = document.getElementById("theme-toggle");

      function currentTheme() {
        var explicit = root.getAttribute("data-theme");
        if (explicit) return explicit;
        return window.matchMedia("(prefers-color-scheme: dark)").matches ? "dark" : "light";
      }

      function renderLabel() {
        var isDark = currentTheme() === "dark";
        btn.textContent = isDark ? {{ site.theme.light_label | tojson }} : {{ site.theme.dark_label | tojson }};
      }

      btn.addEventListener("click", function () {
        var next = currentTheme() === "dark" ? "light" : "dark";
        root.setAttribute("data-theme", next);
        localStorage.setItem("theme", next);
        renderLabel();
      });

      renderLabel();
    })();

    (function () {
      var nav = document.querySelector(".quick-nav");
      if (!nav) return;
      var links = Array.from(nav.querySelectorAll("a[href^='#']"));
      var sections = links
        .map(function (link) { return document.querySelector(link.getAttribute("href")); })
        .filter(Boolean);

      function setActive(id) {
        links.forEach(function (link) {
          var target = link.getAttribute("href").slice(1);
          link.classList.toggle("is-active", target === id);
        });
      }

      if ("IntersectionObserver" in window && sections.length) {
        var observer = new IntersectionObserver(function (entries) {
          entries.forEach(function (entry) {
            if (entry.isIntersecting) {
              setActive(entry.target.id);
            }
          });
        }, { rootMargin: "-35% 0px -55% 0px", threshold: 0.01 });

        sections.forEach(function (section) { observer.observe(section); });
      }

      links.forEach(function (link) {
        link.addEventListener("click", function () {
          setActive(link.getAttribute("href").slice(1));
        });
      });
    })();

    (function () {
      var roleEl = document.getElementById("role-text");
      var articleEl = document.getElementById("role-article");
      if (!roleEl || !articleEl) return;

      var roles = {{ site.hero.roles | tojson }};
      if (!Array.isArray(roles) || roles.length === 0) return;

      var roleIndex = 0;
      var charIndex = 0;
      var deleting = false;
      var holdMs = 1100;

      function articleFor(role) {
        var trimmed = role.trim().toLowerCase();
        if (/^it\b/.test(trimmed)) return "an";
        if (/^[aeiou]/.test(trimmed)) return "an";
        return "a";
      }

      roleEl.textContent = "";
      articleEl.textContent = articleFor(roles[0]);

      function tick() {
        var current = roles[roleIndex];
        articleEl.textContent = articleFor(current);

        if (!deleting) {
          charIndex += 1;
          roleEl.textContent = current.slice(0, charIndex);
          if (charIndex === current.length) {
            deleting = true;
            setTimeout(tick, holdMs);
            return;
          }
          setTimeout(tick, 85);
          return;
        }

        charIndex -= 1;
        roleEl.textContent = current.slice(0, charIndex);
        if (charIndex === 0) {
          deleting = false;
          roleIndex = (roleIndex + 1) % roles.length;
          setTimeout(tick, 220);
          return;
        }
        setTimeout(tick, 45);
      }

      tick();
    })();
  </script>
</body>
</html>
